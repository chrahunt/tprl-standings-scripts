# TPRL Google Sheet Standings

This repository contains the scripts used in TPRL (/r/tagproracing) for score calculation and updating.

The files for the weekly competitions are in the `weekly` folder. The files for calculating season standings are in the `season` folder.

## Setup

For both the Weekly and Season sheets, you must make a Google Sheet, create a bound Script project (from the opened sheet, go to `Tools > Script Editor...`). Copy the contents into files in the Script editor. Can't drag-and-drop here, so make the individual files (with the same names, at least for the non-.gs files), and copy the contents pver

The Weekly Google sheet requires no setup, though it would make sense to remove the auto-created `Sheet1` (after uploading the results from a single round, so it is not the only sheet left).

The Season Google sheet must have a sheet named `Events` with columns
1. Number - Number of the event in the season (e.g. first event is 1)
2. Stats File URL - URL to the Google Sheet with the standings for the event (as generated by the Weekly script)
3. Recap Thread - Doesn't matter, just a column for whatever you want.
4. Date - The date the event took place.

The names of the columns do not matter but their order does.

The Season Google sheet must also have a sheet named `Formatting`. The formatting applied to the following cells will be used on the main `Standings` sheet:
* `A2`: Rank difference (column C of Standings sheet)
* `B2`: Streak (column G of Standings sheet)
* `C2`: Ranks Below Best Rank (column K of Standings sheet)

The current formats applied to each are:
* Rank Difference:
  * Custom number format: ▲#,###; ▼-#,###; ✔ 0
  * Conditional Formatting: if text contains ▲, green; if text contains ▼, red.
* Streak:
  * Conditional Formatting: if text contains W, blue; if text contails L, red.
* Ranks Below Best Rank:
  * Conditional Formatting: if value is 0, green; if value is 1 to 4, light green; if value is 5 to 10, light red; and so on.

